"use strict";const o=require("../../common/vendor.js"),e=require("../../common/assets.js");if(!Array){o.resolveComponent("uni-icons")()}Math;const t={__name:"publish",setup(t){const d=new Date,i=o.reactive({goodName:"",goodProducterId:getApp().globalData.userid,goodPicture:[],goodDate:d.toLocaleDateString(),goodPrice:0,goodText:""}),a=()=>{const e=i.goodPicture.join(",");o.index.request({url:"http://127.0.0.1:3000/good/addgood",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},data:{goodName:i.goodName,goodProducterId:i.goodProducterId,goodPicture:e,goodDate:i.goodDate,goodPrice:i.goodPrice,goodText:i.goodText},success(e){o.index.showToast({title:"发布成功"}),setTimeout((()=>{o.index.redirectTo({url:"/pages/home3/home3"})}),1500)},fail(o){console.log(o)}})},r=()=>{i.goodPicture.join(","),o.index.chooseImage({count:1,success(e){if(e.tempFilePaths.length>0){let t=e.tempFilePaths[0];o.index.showLoading({title:"上传中..",mask:!0}),o.Es.uploadFile({filePath:t,cloudPath:"a.png",onUploadProgress:function(o){console.log(o),Math.round(100*o.loaded/o.total)},success(o){i.goodPicture.push(o.fileID)},fail(){o.index.showToast({title:"上传失败",icon:"error"}),o.index.hideLoading()},complete(){o.index.hideLoading()}})}}})};return(t,d)=>o.e({a:i.goodName,b:o.o((o=>i.goodName=o.detail.value)),c:i.goodText,d:o.o((o=>i.goodText=o.detail.value)),e:o.f(i.goodPicture,((e,t,d)=>({a:"0b20e254-0-"+d,b:o.o((o=>(o=>{i.goodPicture.splice(o,1)})(t)),t),c:e,d:t}))),f:o.p({type:"closeempty",size:"12",color:"#fff"}),g:i.goodPicture.length<9},i.goodPicture.length<9?{h:o.p({type:"plus-filled",size:"20",color:"#949494"}),i:o.o(r)}:{},{j:e._imports_0$1,k:i.goodPrice,l:o.o((o=>i.goodPrice=o.detail.value)),m:o.o(a)})}};wx.createPage(t);
